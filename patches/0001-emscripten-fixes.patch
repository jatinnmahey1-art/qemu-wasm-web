diff --git a/configure b/configure
index 0000000..1111111 100755
--- a/configure
+++ b/configure
@@ -1,5 +1,20 @@
 #!/bin/sh
 # This script is generated by the QEMU configure script
 
+# --- EMSCRIPTEN / WASM HACKS ---
+if echo "$CC" | grep -q emcc || echo "$CXX" | grep -q em++; then
+    echo "Emscripten detected - forcing riscv64-softmmu"
+    target_list="riscv64-softmmu $target_list"
+    pie="no"
+    kvm="no"
+    xen="no"
+    hax="no"
+    hvf="no"
+    whpx="no"
+    nvmm="no"
+    linux_user="no"
+    bsd_user="no"
+    guest_agent="no"
+fi
+# -------------------------------
+
 # Default configuration
 softmmu="yes"
 linux_user="yes"
diff --git a/util/qemu-thread-posix.c b/util/qemu-thread-posix.c
index 0000000..2222222 100644
--- a/util/qemu-thread-posix.c
+++ b/util/qemu-thread-posix.c
@@ -20,6 +20,12 @@
 #include "qemu/thread.h"
 #include "qemu/atomic.h"
 
+#ifdef __EMSCRIPTEN__
+#define pthread_self() ((pthread_t)1)
+#define pthread_create(t, a, f, d) (-1)
+#define pthread_join(t, v) (0)
+#endif
+
 static bool name_threads;
 
 void qemu_thread_naming(bool enable)
